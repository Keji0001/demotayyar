<!DOCTYPE html>
<html lang="en" dir="ltr" id="app-root">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tayyar - ÿ™Ÿäÿßÿ±</title>
    <meta name="theme-color" content="#2c5aa0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2c5aa0;
            --primary-light: #4a90e2;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --tourism: #e91e63;
            --electric: #00bcd4;
            --text: #333;
            --bg: #f8f9fa;
            --card: white;
            --border: #e0e0e0;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.5;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }

        .language-toggle {
            position: fixed;
            top: 12px;
            right: 12px;
            z-index: 1001;
            background: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .language-toggle:hover {
            background: var(--primary-light);
        }

        .screen {
            display: none;
            min-height: 100vh;
            padding: 20px 20px 100px;
            max-width: 400px;
            margin: 0 auto;
            background: var(--card);
            position: relative;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }

        .screen.active {
            display: block;
        }

        #screen2.active, #screen4.active, #screen5.active {
            display: flex;
            flex-direction: column;
            padding: 20px 20px 0;
        }

        .header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--border);
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            background: var(--card);
            z-index: 10;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .header h2 {
            font-size: 14px;
            color: #666;
            font-weight: 400;
        }

        .map-container {
            height: 200px;
            border-radius: 12px;
            overflow: hidden;
            margin: 20px 0;
            position: relative;
            background: #e8f4fd;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .map-container:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .map-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .bus-overlay {
            position: absolute;
            top: 12px;
            left: 12px;
            right: 12px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .bus-marker {
            background: var(--primary);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
            animation: pulse 2s infinite;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .bus-marker:hover {
            transform: scale(1.05);
        }

        .bus-marker.electric {
            background: var(--electric);
        }

        .bus-marker.tourism {
            background: var(--tourism);
        }

        .bus-stops {
            margin-bottom: 20px;
        }

        .bus-stop {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .bus-stop:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .stop-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .stop-name {
            font-weight: 600;
            font-size: 16px;
        }

        .stop-eta {
            background: var(--success);
            color: white;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .stop-details {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }

        .amenities {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .amenity {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 6px;
            font-size: 10px;
            color: #666;
            transition: all 0.3s ease;
        }

        .amenity:hover {
            background: #e0e0e0;
            transform: translateY(-1px);
        }

        /* Chat Screen */
        .chat-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
            padding: 0 0 16px 0;
            border-bottom: 1px solid var(--border);
        }

        .suggestion {
            background: #e3f2fd;
            color: var(--primary);
            border: none;
            padding: 8px 12px;
            border-radius: 16px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suggestion:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-1px);
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0;
            min-height: 300px;
            max-height: 60vh;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }

        .message {
            margin: 12px 0;
            padding: 12px 16px;
            border-radius: 16px;
            max-width: 85%;
            animation: fadeIn 0.3s ease-in-out;
            word-wrap: break-word;
        }

        .user-message {
            background: var(--primary);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .ai-message {
            background: #f0f0f0;
            color: var(--text);
            border-bottom-left-radius: 5px;
        }

        .chat-input-area {
            padding: 16px 0 20px;
            border-top: 1px solid var(--border);
            background: var(--card);
            position: sticky;
            bottom: 0;
        }

        .chat-input-container {
            display: flex;
            gap: 8px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
        }

        .chat-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
        }

        .send-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 70px;
        }

        .send-btn:hover {
            background: var(--primary-light);
            transform: translateY(-1px);
        }

        /* Payment Screen */
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .balance-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            text-align: center;
        }

        .balance {
            font-size: 32px;
            font-weight: 700;
            margin: 8px 0;
            transition: all 0.3s ease;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 16px 0;
        }

        .action {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
        }

        .action:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .action-icon {
            font-size: 24px;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .action-label {
            font-size: 14px;
            font-weight: 500;
        }

        /* Family Screen */
        .family-member {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background: var(--card);
            border-radius: 12px;
            margin: 12px 0;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .family-member:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .member-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .member-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-light);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .member-avatar:hover {
            transform: scale(1.05);
        }

        .member-status {
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .status-traveling {
            background: #e8f5e8;
            color: var(--success);
        }

        .status-arrived {
            background: #e3f2fd;
            color: var(--primary);
        }

        /* Tourism Screen */
        .route-card {
            background: linear-gradient(135deg, var(--tourism) 0%, #f06292 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 16px 0;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .route-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .route-name {
            font-size: 18px;
            font-weight: 600;
        }

        .route-price {
            background: rgba(255,255,255,0.3);
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .route-price:hover {
            background: rgba(255,255,255,0.4);
        }

        .attractions {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 8px;
        }

        .attraction {
            background: rgba(255,255,255,0.2);
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .attraction:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-1px);
        }

        /* Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 400px;
            background: var(--card);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            padding: 8px 0 12px;
            z-index: 1000;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 4px;
            cursor: pointer;
            color: #666;
            flex: 1;
            text-align: center;
            transition: all 0.3s ease;
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-item:hover {
            color: var(--primary);
            transform: translateY(-2px);
        }

        .nav-icon {
            font-size: 18px;
            margin-bottom: 2px;
        }

        .nav-label {
            font-size: 10px;
            font-weight: 500;
        }

        /* Modal System */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1003;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            opacity: 1;
        }

        .modal-content {
            background: var(--card);
            padding: 24px;
            border-radius: 16px;
            max-width: 320px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transform: translateY(20px);
            transition: all 0.3s ease;
            opacity: 0;
            max-height: 70vh;
            overflow-y: auto;
        }

        .modal.active .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .modal-close {
            background: var(--border);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            margin-top: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: #d0d0d0;
        }

        .action-btn {
            display: block;
            width: 100%;
            margin: 8px 0;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: var(--primary-light);
            transform: translateY(-1px);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            z-index: 1002;
            opacity: 0;
            transition: opacity 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .notification.show {
            opacity: 1;
        }

        /* Loading Indicators */
        .spinner {
            width: 40px;
            height: 40px;
            margin: 20px auto;
            border: 3px solid var(--border);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .screen {
                padding: 16px 16px 100px;
                max-width: 100%;
            }
            
            #screen2.active, #screen4.active, #screen5.active {
                padding: 16px 16px 0;
            }
            
            .header {
                padding: 16px 0;
            }
        }

        /* Animations */
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }

        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
    </style>
</head>
<body>
    <button class="language-toggle" onclick="toggleLanguage()" id="langToggle">ÿπÿ±ÿ®Ÿä</button>
    
    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <h3 id="modalTitle">Title</h3>
            <div id="modalBody">Content</div>
            <button class="modal-close" onclick="closeModal()">Close</button>
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <!-- Home Screen -->
    <div id="screen1" class="screen active">
        <header class="header">
            <h1 data-en="Tayyar" data-ar="ÿ™Ÿäÿßÿ±">Tayyar</h1>
            <h2 data-en="Smart Transit" data-ar="ÿßŸÑŸÜŸÇŸÑ ÿßŸÑÿ∞ŸÉŸä">Smart Transit</h2>
        </header>
        
        <div class="map-container">
            <iframe 
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14424.123456789!2d55.5136!3d25.4052!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3ef5f43348a67c47%3A0x1bb0f2d7c0b6b8a0!2sAjman%2C%20United%20Arab%20Emirates!5e0!3m2!1sen!2sus!4v1234567890123" 
                allowfullscreen loading="lazy">
            </iframe>
            <div class="bus-overlay">
                <div class="bus-marker electric" onclick="showBusDetails('AJX')">
                    ‚ö° <span data-en="AJX - 4 min" data-ar="AJX - 4 ÿØŸÇÿßÿ¶ŸÇ">AJX - 4 min</span>
                </div>
                <div class="bus-marker tourism" onclick="showBusDetails('RT1')">
                    üèõÔ∏è <span data-en="RT1 - 8 min" data-ar="RT1 - 8 ÿØŸÇÿßÿ¶ŸÇ">RT1 - 8 min</span>
                </div>
                <div class="bus-marker" onclick="showBusDetails('B7')">
                    üöå <span data-en="B7 - 12 min" data-ar="B7 - 12 ÿØŸÇŸäŸÇÿ©">B7 - 12 min</span>
                </div>
            </div>
        </div>
        
        <div class="bus-stops">
            <div class="bus-stop" onclick="showStopDetails('School Complex')">
                <div class="stop-header">
                    <div class="stop-name" data-en="School Complex" data-ar="ŸÖÿ¨ŸÖÿπ ÿßŸÑŸÖÿØÿßÿ±ÿ≥">School Complex</div>
                    <div class="stop-eta" data-en="4 min" data-ar="4 ÿØŸÇÿßÿ¶ŸÇ">4 min</div>
                </div>
                <div class="stop-details" data-en="6 min walk" data-ar="6 ÿØŸÇÿßÿ¶ŸÇ ŸÖÿ¥Ÿä">6 min walk</div>
                <div class="amenities">
                    <span class="amenity" data-en="‚ö° Electric" data-ar="‚ö° ŸÉŸáÿ±ÿ®ÿßÿ¶Ÿä">‚ö° Electric</span>
                    <span class="amenity" data-en="üöª Facilities" data-ar="üöª ŸÖÿ±ÿßŸÅŸÇ">üöª Facilities</span>
                    <span class="amenity" data-en="‚òï Caf√©" data-ar="‚òï ŸÖŸÇŸáŸâ">‚òï Caf√©</span>
                </div>
            </div>

            <div class="bus-stop" onclick="showStopDetails('City Center')">
                <div class="stop-header">
                    <div class="stop-name" data-en="City Center" data-ar="ÿ≥Ÿäÿ™Ÿä ÿ≥ŸÜÿ™ÿ±">City Center</div>
                    <div class="stop-eta" data-en="12 min" data-ar="12 ÿØŸÇŸäŸÇÿ©">12 min</div>
                </div>
                <div class="stop-details" data-en="15 min walk" data-ar="15 ÿØŸÇŸäŸÇÿ© ŸÖÿ¥Ÿä">15 min walk</div>
                <div class="amenities">
                    <span class="amenity" data-en="üèõÔ∏è Tourism" data-ar="üèõÔ∏è ÿ≥Ÿäÿßÿ≠ÿ©">üèõÔ∏è Tourism</span>
                    <span class="amenity" data-en="üõçÔ∏è Shopping" data-ar="üõçÔ∏è ÿ™ÿ≥ŸàŸÇ">üõçÔ∏è Shopping</span>
                    <span class="amenity" data-en="üçΩÔ∏è Food" data-ar="üçΩÔ∏è ÿ∑ÿπÿßŸÖ">üçΩÔ∏è Food</span>
                </div>
            </div>

            <div class="bus-stop" onclick="showStopDetails('Al Jurf')">
                <div class="stop-header">
                    <div class="stop-name" data-en="Al Jurf" data-ar="ÿßŸÑÿ¨ÿ±ŸÅ">Al Jurf</div>
                    <div class="stop-eta" data-en="18 min" data-ar="18 ÿØŸÇŸäŸÇÿ©">18 min</div>
                </div>
                <div class="stop-details" data-en="10 min walk" data-ar="10 ÿØŸÇÿßÿ¶ŸÇ ŸÖÿ¥Ÿä">10 min walk</div>
                <div class="amenities">
                    <span class="amenity" data-en="üåä Beach" data-ar="üåä ÿ¥ÿßÿ∑ÿ¶">üåä Beach</span>
                    <span class="amenity" data-en="üöª Facilities" data-ar="üöª ŸÖÿ±ÿßŸÅŸÇ">üöª Facilities</span>
                    <span class="amenity" data-en="üèùÔ∏è Park" data-ar="üèùÔ∏è ÿ≠ÿØŸäŸÇÿ©">üèùÔ∏è Park</span>
                </div>
            </div>

            <div class="bus-stop" onclick="showStopDetails('University')">
                <div class="stop-header">
                    <div class="stop-name" data-en="UAE University" data-ar="ÿ¨ÿßŸÖÿπÿ© ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™">UAE University</div>
                    <div class="stop-eta" data-en="22 min" data-ar="22 ÿØŸÇŸäŸÇÿ©">22 min</div>
                </div>
                <div class="stop-details" data-en="5 min walk" data-ar="5 ÿØŸÇÿßÿ¶ŸÇ ŸÖÿ¥Ÿä">5 min walk</div>
                <div class="amenities">
                    <span class="amenity" data-en="üéì Campus" data-ar="üéì ÿ≠ÿ±ŸÖ ÿ¨ÿßŸÖÿπŸä">üéì Campus</span>
                    <span class="amenity" data-en="üìö Library" data-ar="üìö ŸÖŸÉÿ™ÿ®ÿ©">üìö Library</span>
                    <span class="amenity" data-en="üçΩÔ∏è Food" data-ar="üçΩÔ∏è ÿ∑ÿπÿßŸÖ">üçΩÔ∏è Food</span>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Chat Screen -->
    <div id="screen2" class="screen">
        <header class="header">
            <h1 data-en="AI Assistant" data-ar="ÿßŸÑŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ∞ŸÉŸä">AI Assistant</h1>
            <h2 data-en="Trip Planning" data-ar="ÿ™ÿÆÿ∑Ÿäÿ∑ ÿßŸÑÿ±ÿ≠ŸÑÿßÿ™">Trip Planning</h2>
        </header>
        
        <div class="chat-content">
            <div class="suggestions">
                <button class="suggestion" onclick="sendSuggestion(this)" data-en="Plan route" data-ar="ÿÆÿ∑ÿ∑ ÿßŸÑÿ∑ÿ±ŸäŸÇ">Plan route</button>
                <button class="suggestion" onclick="sendSuggestion(this)" data-en="Find amenities" data-ar="ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑŸÖÿ±ÿßŸÅŸÇ">Find amenities</button>
                <button class="suggestion" onclick="sendSuggestion(this)" data-en="Tourism routes" data-ar="ÿßŸÑÿ∑ÿ±ŸÇ ÿßŸÑÿ≥Ÿäÿßÿ≠Ÿäÿ©">Tourism routes</button>
                <button class="suggestion" onclick="sendSuggestion(this)" data-en="Check delays" data-ar="ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ™ÿ£ÿÆŸäÿ±">Check delays</button>
                <button class="suggestion" onclick="sendSuggestion(this)" data-en="Villa routes" data-ar="ÿ∑ÿ±ŸÇ ÿßŸÑŸÅŸÑŸÑ">Villa routes</button>
                <button class="suggestion" onclick="sendSuggestion(this)" data-en="Electric buses" data-ar="ÿßŸÑÿ®ÿßÿµÿßÿ™ ÿßŸÑŸÉŸáÿ±ÿ®ÿßÿ¶Ÿäÿ©">Electric buses</button>
            </div>
            
            <div class="chat-container" id="chatContainer">
                <div class="message ai-message" id="welcomeMessage">
                    <span data-en="üëã <strong>Welcome to Tayyar!</strong><br><br>How can I help you today?" data-ar="üëã <strong>ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ŸÉ ŸÅŸä ÿ∑Ÿäÿßÿ±!</strong><br><br>ŸÉŸäŸÅ ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿßŸÑŸäŸàŸÖÿü">üëã <strong>Welcome to Tayyar!</strong><br><br>How can I help you today?</span>
                </div>
            </div>
        </div>
        
        <div class="chat-input-area">
            <div class="chat-input-container">
                <input type="text" id="chatInput" placeholder="Ask me anything..." class="chat-input" data-en="Ask me anything..." data-ar="ÿßÿ≥ÿ£ŸÑŸÜŸä ÿ£Ÿä ÿ¥Ÿäÿ°...">
                <button onclick="sendMessage()" class="send-btn" data-en="Send" data-ar="ÿ•ÿ±ÿ≥ÿßŸÑ">Send</button>
            </div>
        </div>
    </div>

    <!-- Payment Screen -->
    <div id="screen3" class="screen">
        <header class="header">
            <h1 data-en="Masaar Pay" data-ar="ÿØŸÅÿπ ŸÖÿ≥ÿßÿ±">Masaar Pay</h1>
            <h2 data-en="Digital Wallet" data-ar="ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ© ÿßŸÑÿ±ŸÇŸÖŸäÿ©">Digital Wallet</h2>
        </header>
        
        <div class="card balance-card">
            <div data-en="Balance" data-ar="ÿßŸÑÿ±ÿµŸäÿØ">Balance</div>
            <div class="balance" id="balance">127.50 AED</div>
        </div>

        <div class="actions-grid">
            <div class="action" onclick="topUpBalance()">
                <div class="action-icon">üí≥</div>
                <div class="action-label" data-en="Top Up" data-ar="ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ¥ÿ≠ŸÜ">Top Up</div>
            </div>
            <div class="action" onclick="initiateNFCPayment()">
                <div class="action-icon">üì±</div>
                <div class="action-label" data-en="NFC Pay" data-ar="ÿØŸÅÿπ NFC">NFC Pay</div>
            </div>
            <div class="action" onclick="showPasses()">
                <div class="action-icon">üé´</div>
                <div class="action-label" data-en="Passes" data-ar="ÿßŸÑÿßÿ¥ÿ™ÿ±ÿßŸÉÿßÿ™">Passes</div>
            </div>
            <div class="action" onclick="showTransactionHistory()">
                <div class="action-icon">üìä</div>
                <div class="action-label" data-en="History" data-ar="ÿßŸÑÿ≥ÿ¨ŸÑ">History</div>
            </div>
        </div>

        <div class="card">
            <h3 data-en="Recent Transactions" data-ar="ÿßŸÑŸÖÿπÿßŸÖŸÑÿßÿ™ ÿßŸÑÿ£ÿÆŸäÿ±ÿ©">Recent Transactions</h3>
            <div id="transactionList" style="margin-top: 12px; font-size: 14px; color: #666;">
                <div class="transaction" style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px 0; border-bottom: 1px solid var(--border);">
                    <span data-en="Bus AJX - Today" data-ar="ÿ®ÿßÿµ AJX - ÿßŸÑŸäŸàŸÖ">Bus AJX - Today</span>
                    <span style="color: var(--danger);">-3.50 AED</span>
                </div>
                <div class="transaction" style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px 0; border-bottom: 1px solid var(--border);">
                    <span data-en="Top Up - Yesterday" data-ar="ÿ¥ÿ≠ŸÜ - ÿ£ŸÖÿ≥">Top Up - Yesterday</span>
                    <span style="color: var(--success);">+50.00 AED</span>
                </div>
                <div class="transaction" style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px 0; border-bottom: 1px solid var(--border);">
                    <span data-en="Bus B7 - Yesterday" data-ar="ÿ®ÿßÿµ B7 - ÿ£ŸÖÿ≥">Bus B7 - Yesterday</span>
                    <span style="color: var(--danger);">-3.50 AED</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Family Screen -->
    <div id="screen4" class="screen">
        <header class="header">
            <h1 data-en="Family" data-ar="ÿßŸÑÿπÿßÿ¶ŸÑÿ©">Family</h1>
            <h2 data-en="Track Members" data-ar="ÿ™ÿ™ÿ®ÿπ ÿßŸÑÿ£ŸÅÿ±ÿßÿØ">Track Members</h2>
        </header>

        <div id="familyMembers">
            <div class="family-member" onclick="showMemberDetails('Khalid')">
                <div class="member-info">
                    <div class="member-avatar">K</div>
                    <div>
                        <div style="font-weight: 600;" data-en="Khalid" data-ar="ÿÆÿßŸÑÿØ">Khalid</div>
                        <div style="font-size: 12px; color: #666;" data-en="On Bus AJX ‚Üí City Center" data-ar="ŸÅŸä ÿßŸÑÿ®ÿßÿµ AJX ‚Üí ÿ≥Ÿäÿ™Ÿä ÿ≥ŸÜÿ™ÿ±">On Bus AJX ‚Üí City Center</div>
                        <div style="font-size: 10px; color: #999;" data-en="ETA: 7:15 PM" data-ar="ÿßŸÑŸàÿµŸàŸÑ ÿßŸÑŸÖÿ™ŸàŸÇÿπ: 7:15 ŸÖÿ≥ÿßÿ°Ÿã">ETA: 7:15 PM</div>
                    </div>
                </div>
                <div class="member-status status-traveling" data-en="Traveling" data-ar="ŸÅŸä ÿßŸÑÿ∑ÿ±ŸäŸÇ">Traveling</div>
            </div>

            <div class="family-member" onclick="showMemberDetails('Sara')">
                <div class="member-info">
                    <div class="member-avatar">S</div>
                    <div>
                        <div style="font-weight: 600;" data-en="Sara" data-ar="ÿ≥ÿßÿ±ÿ©">Sara</div>
                        <div style="font-size: 12px; color: #666;" data-en="On Bus B7 ‚Üí Al Noor School" data-ar="ŸÅŸä ÿßŸÑÿ®ÿßÿµ B7 ‚Üí ŸÖÿØÿ±ÿ≥ÿ© ÿßŸÑŸÜŸàÿ±">On Bus B7 ‚Üí Al Noor School</div>
                        <div style="font-size: 10px; color: #999;" data-en="ETA: 7:30 PM" data-ar="ÿßŸÑŸàÿµŸàŸÑ ÿßŸÑŸÖÿ™ŸàŸÇÿπ: 7:30 ŸÖÿ≥ÿßÿ°Ÿã">ETA: 7:30 PM</div>
                    </div>
                </div>
                <div class="member-status status-traveling" data-en="Traveling" data-ar="ŸÅŸä ÿßŸÑÿ∑ÿ±ŸäŸÇ">Traveling</div>
            </div>

            <div class="family-member" onclick="showMemberDetails('Ahmed')">
                <div class="member-info">
                    <div class="member-avatar">A</div>
                    <div>
                        <div style="font-weight: 600;" data-en="Ahmed" data-ar="ÿ£ÿ≠ŸÖÿØ">Ahmed</div>
                        <div style="font-size: 12px; color: #666;" data-en="At UAE University" data-ar="ŸÅŸä ÿ¨ÿßŸÖÿπÿ© ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™">At UAE University</div>
                        <div style="font-size: 10px; color: #999;" data-en="Arrived: 6:45 PM" data-ar="ŸàÿµŸÑ: 6:45 ŸÖÿ≥ÿßÿ°Ÿã">Arrived: 6:45 PM</div>
                    </div>
                </div>
                <div class="member-status status-arrived" data-en="Arrived" data-ar="ŸàÿµŸÑ">Arrived</div>
            </div>
        </div>

        <div class="card">
            <h3 data-en="Settings" data-ar="ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™">Settings</h3>
            <div style="margin-top: 16px; display: grid; gap: 12px;">
                <div class="action" onclick="toggleNotifications()">
                    <div class="action-icon">üîî</div>
                    <div class="action-label" data-en="Notifications" data-ar="ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™">Notifications</div>
                </div>
                <div class="action" onclick="addFamilyMember()">
                    <div class="action-icon">‚ûï</div>
                    <div class="action-label" data-en="Add Member" data-ar="ÿ•ÿ∂ÿßŸÅÿ© ŸÅÿ±ÿØ">Add Member</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tourism Screen -->
    <div id="screen5" class="screen">
        <header class="header">
            <h1 data-en="Tourism" data-ar="ÿßŸÑÿ≥Ÿäÿßÿ≠ÿ©">Tourism</h1>
            <h2 data-en="Discover Ajman" data-ar="ÿßŸÉÿ™ÿ¥ŸÅ ÿπÿ¨ŸÖÿßŸÜ">Discover Ajman</h2>
        </header>

        <div class="route-card">
            <div class="route-header">
                <div class="route-name" data-en="Discovery Pass" data-ar="ÿ™ÿ∞ŸÉÿ±ÿ© ÿßŸÑÿßÿ≥ÿ™ŸÉÿ¥ÿßŸÅ">Discovery Pass</div>
                <div class="route-price" onclick="purchaseDiscoveryPass()" data-en="15 AED/day" data-ar="15 ÿØÿ±ŸáŸÖ/ŸäŸàŸÖ">15 AED/day</div>
            </div>
            <div style="font-size: 14px; margin-bottom: 8px;" data-en="All-day access to tourist routes" data-ar="ŸàÿµŸàŸÑ ÿ∑ŸàÿßŸÑ ÿßŸÑŸäŸàŸÖ ŸÑŸÑÿ∑ÿ±ŸÇ ÿßŸÑÿ≥Ÿäÿßÿ≠Ÿäÿ©">All-day access to tourist routes</div>
            <div class="attractions">
                <span class="attraction" onclick="showAttractionDetails('Museum')" data-en="üèõÔ∏è Museum" data-ar="üèõÔ∏è ÿßŸÑŸÖÿ™ÿ≠ŸÅ">üèõÔ∏è Museum</span>
                <span class="attraction" onclick="showAttractionDetails('Corniche')" data-en="üåä Corniche" data-ar="üåä ÿßŸÑŸÉŸàÿ±ŸÜŸäÿ¥">üåä Corniche</span>
                <span class="attraction" onclick="showAttractionDetails('Al Zorah')" data-en="üèùÔ∏è Al Zorah" data-ar="üèùÔ∏è ÿßŸÑÿ≤Ÿàÿ±ÿßÿ°">üèùÔ∏è Al Zorah</span>
                <span class="attraction" onclick="showAttractionDetails('Mall')" data-en="üõçÔ∏è Mall" data-ar="üõçÔ∏è ÿßŸÑŸÖŸàŸÑ">üõçÔ∏è Mall</span>
            </div>
        </div>

        <div class="card">
            <h3 data-en="Popular Routes" data-ar="ÿßŸÑÿ∑ÿ±ŸÇ ÿßŸÑÿ¥ÿßÿ¶ÿπÿ©">Popular Routes</h3>
            <div style="margin-top: 16px; display: grid; gap: 12px;">
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" onclick="showRouteDetails('RT1')">
                    <span data-en="RT1: City Heritage Tour" data-ar="RT1: ÿ¨ŸàŸÑÿ© ÿßŸÑÿ™ÿ±ÿßÿ´">RT1: City Heritage Tour</span>
                    <span style="color: var(--primary); font-weight: 600;" data-en="Every 20 min" data-ar="ŸÉŸÑ 20 ÿØŸÇŸäŸÇÿ©">Every 20 min</span>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" onclick="showRouteDetails('RT2')">
                    <span data-en="RT2: Beach & Nature" data-ar="RT2: ÿßŸÑÿ¥ÿßÿ∑ÿ¶ ŸàÿßŸÑÿ∑ÿ®Ÿäÿπÿ©">RT2: Beach & Nature</span>
                    <span style="color: var(--primary); font-weight: 600;" data-en="Every 30 min" data-ar="ŸÉŸÑ 30 ÿØŸÇŸäŸÇÿ©">Every 30 min</span>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f8f9fa; border-radius: 8px; cursor: pointer;" onclick="showRouteDetails('RT3')">
                    <span data-en="RT3: Hotel Circuit" data-ar="RT3: ÿØÿßÿ¶ÿ±ÿ© ÿßŸÑŸÅŸÜÿßÿØŸÇ">RT3: Hotel Circuit</span>
                    <span style="color: var(--primary); font-weight: 600;" data-en="Every 25 min" data-ar="ŸÉŸÑ 25 ÿØŸÇŸäŸÇÿ©">Every 25 min</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h3 data-en="Villa Community Routes" data-ar="ÿ∑ÿ±ŸÇ ŸÖÿ¨ÿ™ŸÖÿπÿßÿ™ ÿßŸÑŸÅŸÑŸÑ">Villa Community Routes</h3>
            <div style="margin-top: 16px;">
                <div style="padding: 16px; background: linear-gradient(135deg, var(--electric) 0%, #4dd0e1 100%); color: white; border-radius: 12px; cursor: pointer; transition: all 0.3s ease;" onclick="showMinibusDetails('Al Amerah')" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                        <span style="font-weight: 600;" data-en="üöê Al Amerah Minibus" data-ar="üöê ÿ≠ÿßŸÅŸÑÿ© ÿµÿ∫Ÿäÿ±ÿ© ÿßŸÑÿπÿßŸÖÿ±ÿ©">üöê Al Amerah Minibus</span>
                        <span data-en="Every 10-15 min" data-ar="ŸÉŸÑ 10-15 ÿØŸÇŸäŸÇÿ©">Every 10-15 min</span>
                    </div>
                    <div style="font-size: 12px; opacity: 0.9;" data-en="Electric mini-buses ‚Ä¢ 7.2 km route ‚Ä¢ 8 stops" data-ar="ÿ≠ÿßŸÅŸÑÿßÿ™ ÿµÿ∫Ÿäÿ±ÿ© ŸÉŸáÿ±ÿ®ÿßÿ¶Ÿäÿ© ‚Ä¢ ŸÖÿ≥ÿßÿ± 7.2 ŸÉŸÖ ‚Ä¢ 8 ŸÖÿ≠ÿ∑ÿßÿ™">Electric mini-buses ‚Ä¢ 7.2 km route ‚Ä¢ 8 stops</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="showScreen(1)" data-screen="1">
            <div class="nav-icon">üè†</div>
            <div class="nav-label" data-en="Home" data-ar="ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©">Home</div>
        </div>
        <div class="nav-item" onclick="showScreen(2)" data-screen="2">
            <div class="nav-icon">ü§ñ</div>
            <div class="nav-label" data-en="AI" data-ar="ÿ∞ŸÉŸä">AI</div>
        </div>
        <div class="nav-item" onclick="showScreen(3)" data-screen="3">
            <div class="nav-icon">üí≥</div>
            <div class="nav-label" data-en="Pay" data-ar="ÿØŸÅÿπ">Pay</div>
        </div>
        <div class="nav-item" onclick="showScreen(4)" data-screen="4">
            <div class="nav-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
            <div class="nav-label" data-en="Family" data-ar="ÿßŸÑÿπÿßÿ¶ŸÑÿ©">Family</div>
        </div>
        <div class="nav-item" onclick="showScreen(5)" data-screen="5">
            <div class="nav-icon">üèõÔ∏è</div>
            <div class="nav-label" data-en="Tourism" data-ar="ÿßŸÑÿ≥Ÿäÿßÿ≠ÿ©">Tourism</div>
        </div>
    </nav>

    <script>
        let currentLanguage = 'en';
        
        function showScreen(screenNumber) {
            document.querySelectorAll('.screen').forEach(s => {
                s.classList.remove('active');
                s.scrollTop = 0;
            });
            
            document.querySelectorAll('.nav-item').forEach(n => {
                n.classList.remove('active');
            });
            
            const screen = document.getElementById(`screen${screenNumber}`);
            const nav = document.querySelector(`[data-screen="${screenNumber}"]`);
            
            if (screen) {
                screen.classList.add('active', 'slide-in');
                setTimeout(() => screen.classList.remove('slide-in'), 300);
                
                if (nav) nav.classList.add('active');
                
                if (screenNumber === 2) {
                    setTimeout(() => document.getElementById('chatInput').focus(), 300);
                }
            }
        }

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'ar' : 'en';
            const root = document.getElementById('app-root');
            const toggle = document.getElementById('langToggle');
            
            if (currentLanguage === 'ar') {
                root.setAttribute('dir', 'rtl');
                toggle.textContent = 'English';
            } else {
                root.setAttribute('dir', 'ltr');
                toggle.textContent = 'ÿπÿ±ÿ®Ÿä';
            }
            
            document.querySelectorAll('[data-en]').forEach(el => {
                const text = el.getAttribute(`data-${currentLanguage}`);
                if (text) {
                    if (el.tagName === 'INPUT') {
                        el.placeholder = text;
                    } else {
                        if (text.includes('<')) {
                            el.innerHTML = text;
                        } else {
                            el.textContent = text;
                        }
                    }
                }
            });
            
            showNotification(currentLanguage === 'en' ? 'Language changed to English' : 'ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸÑÿ∫ÿ© ÿ•ŸÑŸâ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©');
        }

        // Chat functionality with comprehensive responses
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                addMessage(message, 'user');
                input.value = '';
                
                showTypingIndicator();
                setTimeout(() => {
                    removeTypingIndicator();
                    handleAIResponse(message);
                }, 1500);
            }
        }

        function showTypingIndicator() {
            const chatContainer = document.getElementById('chatContainer');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typingIndicator';
            typingDiv.className = 'message ai-message';
            typingDiv.innerHTML = '<div style="display: flex; gap: 4px; align-items: center;"><span>AI is typing</span><span style="animation: bounce 0.6s infinite 0.1s;">.</span><span style="animation: bounce 0.6s infinite 0.2s;">.</span><span style="animation: bounce 0.6s infinite 0.3s;">.</span></div>';
            chatContainer.appendChild(typingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) indicator.remove();
        }

        function sendSuggestion(button) {
            const text = button.textContent;
            document.getElementById('chatInput').value = text;
            sendMessage();
        }

        function addMessage(content, type) {
            const container = document.getElementById('chatContainer');
            const msg = document.createElement('div');
            msg.classList.add('message', `${type}-message`, 'fade-in');
            
            if (type === 'ai') {
                msg.innerHTML = content;
            } else {
                msg.textContent = content;
            }
            
            container.appendChild(msg);
            container.scrollTop = container.scrollHeight;
        }

        function handleAIResponse(message) {
            const lower = message.toLowerCase();
            let response = '';
            
            if (lower.includes('villa') && (lower.includes('route') || lower.includes('minibus') || lower.includes('community'))) {
                response = 'üèòÔ∏è <strong>Villa Community Routes</strong><br><br>üöê <strong>Al Amerah Electric Minibus Service</strong><br><br>‚ö° <strong>Key Features:</strong><br>‚Ä¢ 100% electric, zero-emission vehicles<br>‚Ä¢ Every 10-15 minutes (6:00 AM - 10:00 PM)<br>‚Ä¢ 7.2 km route with 8 strategically placed stops<br>‚Ä¢ 13-minute total journey time<br><br>üè† <strong>Coverage:</strong><br>‚Ä¢ All villa communities within 5-10 min walk<br>‚Ä¢ Connects residential areas to main transit at Al Jurf<br>‚Ä¢ Wheelchair accessible with low-floor entry<br>‚Ä¢ Bike racks available for multimodal transport<br><br>üí∞ <strong>Affordable:</strong> Standard Masaar fare (3.50 AED)<br>üå± <strong>Sustainable:</strong> Car-free suburban living solution!';
            } else if (lower.includes('tourism') && lower.includes('route')) {
                response = 'üèõÔ∏è <strong>Tourism Discovery Routes</strong><br><br>üé´ <strong>Rihlat Ajman Discovery Pass - 15 AED/day</strong><br>Unlimited access to all tourist routes + 10% attraction discounts!<br><br>üöå <strong>RT1: Heritage & Culture (Every 20 min)</strong><br>‚Ä¢ Ajman Museum ‚Üí Traditional Souk ‚Üí Ajman Corniche<br>‚Ä¢ 45-minute full loop with audio guides<br>‚Ä¢ Perfect for history and culture enthusiasts<br><br>üèñÔ∏è <strong>RT2: Beach & Nature (Every 30 min)</strong><br>‚Ä¢ Al Zorah Nature Reserve ‚Üí Marina ‚Üí Public Beaches<br>‚Ä¢ 40-minute loop with mangrove tours<br>‚Ä¢ Great for families and nature lovers<br><br>üè® <strong>RT3: Hotel Circuit (Every 25 min)</strong><br>‚Ä¢ Fairmont ‚Üí Oberoi ‚Üí Ajman Saray ‚Üí City Center<br>‚Ä¢ 35-minute luxury hotel route<br>‚Ä¢ Includes luggage assistance<br><br>üéØ <strong>550,000+ tourists</strong> visited Ajman in 2022 using these routes!';
            } else if (lower.includes('plan') || lower.includes('route')) {
                response = 'üó∫Ô∏è <strong>Route Planning</strong><br><br>üìç From your location near School Complex:<br><br>üéØ <strong>Popular destinations:</strong><br>‚Ä¢ <strong>City Center</strong> - 12 min via Bus B7<br>‚Ä¢ <strong>UAE University</strong> - 22 min via Bus AJX (‚ö° Electric)<br>‚Ä¢ <strong>Al Jurf Beach</strong> - 18 min via Bus B7<br>‚Ä¢ <strong>Ajman Corniche</strong> - 15 min via RT1 (Tourism)<br><br>üí° <strong>Pro tip:</strong> Electric buses have dedicated lanes and signal priority for faster travel!';
            } else if (lower.includes('amenities') || lower.includes('facilities')) {
                response = 'üè¢ <strong>Nearby Amenities</strong><br><br>üöª <strong>Restrooms:</strong><br>‚Ä¢ School Complex Stop - Clean, accessible facilities<br>‚Ä¢ City Center - Family rooms with baby changing<br>‚Ä¢ University - Multiple locations<br><br>‚òï <strong>Food & Drink:</strong><br>‚Ä¢ Costa Coffee - 2 min walk from School Complex<br>‚Ä¢ Subway & KFC - Inside City Center<br>‚Ä¢ Cafeteria - UAE University campus<br><br>üèß <strong>ATMs & Banking:</strong><br>‚Ä¢ ADCB ATM - School Complex (Masaar top-up available)<br>‚Ä¢ Emirates NBD - City Center<br>‚Ä¢ Multiple ATMs - University area';
            } else if (lower.includes('tourism') || lower.includes('attractions')) {
                response = 'üèõÔ∏è <strong>Tourism & Attractions</strong><br><br>üé´ <strong>Discovery Pass - Only 15 AED/day</strong><br>Unlimited access to all tourist routes!<br><br>üöå <strong>RT1: Heritage Tour (Every 20 min)</strong><br>‚Ä¢ Ajman Museum - Traditional crafts & history<br>‚Ä¢ Old Souk - Authentic local markets<br>‚Ä¢ Ajman Corniche - Beautiful waterfront<br><br>üèñÔ∏è <strong>RT2: Beach & Nature (Every 30 min)</strong><br>‚Ä¢ Al Zorah Nature Reserve - Mangroves & wildlife<br>‚Ä¢ Public beaches - Swimming & water sports<br>‚Ä¢ Marina walkway - Dining & entertainment<br><br>üé´ Tap "Purchase Discovery Pass" to buy now!';
            } else if (lower.includes('delay') || lower.includes('time') || lower.includes('status')) {
                response = '‚è∞ <strong>Live Service Status</strong><br><br>üü¢ <strong>All routes running normally:</strong><br>‚Ä¢ <strong>Bus AJX</strong> (‚ö° Electric) - On time, next arrival 4 min<br>‚Ä¢ <strong>Bus B7</strong> - On time, next arrival 12 min<br>‚Ä¢ <strong>RT1</strong> (Tourism) - On time, next arrival 8 min<br>‚Ä¢ <strong>RT2</strong> (Beach) - Minor 2 min delay<br><br>‚ö° <strong>Traffic solutions active:</strong><br>‚Ä¢ Bus lanes operational during peak hours<br>‚Ä¢ Signal priority for electric buses<br>‚Ä¢ Real-time GPS tracking<br><br>üì± Updates every 30 seconds via smart city integration';
            } else if ((lower.includes('villa') || lower.includes('suburb') || lower.includes('community') || lower.includes('minibus')) && !lower.includes('route')) {
                response = 'üèòÔ∏è <strong>Villa Community Transport</strong><br><br>üöê <strong>Suburban Minibus Network</strong><br>Connecting villa communities to main transit corridors<br><br>üìç <strong>Currently Serving:</strong><br>‚Ä¢ <strong>Al Amerah Community</strong> - 8 stops, 7.2 km<br>‚Ä¢ <strong>Al Nuaimiya Villas</strong> - 6 stops, 5.8 km<br>‚Ä¢ <strong>Al Rashidiya Residential</strong> - 10 stops, 9.1 km<br><br>üïê <strong>Operating Schedule:</strong><br>‚Ä¢ Peak hours: Every 10-15 minutes<br>‚Ä¢ Off-peak: Every 20-25 minutes<br>‚Ä¢ Service hours: 6:00 AM - 10:00 PM daily<br><br>üîÑ <strong>Main Connections:</strong><br>‚Ä¢ Al Jurf (Beach & B7 bus connection)<br>‚Ä¢ City Center (Shopping & RT1/RT3 tourism)<br>‚Ä¢ School Complex (AJX electric bus)<br><br>‚ôø <strong>Accessibility:</strong> All minibuses are wheelchair accessible with ramps';
            } else if (lower.includes('electric') || lower.includes('green') || lower.includes('environment')) {
                response = '‚ö° <strong>Electric Bus Fleet</strong><br><br>üå± <strong>Environmental benefits:</strong><br>‚Ä¢ 100% electric buses on main routes (AJX, AJY)<br>‚Ä¢ Zero emissions in city center<br>‚Ä¢ 60% quieter than diesel buses<br>‚Ä¢ Solar-powered charging stations<br><br>üöå <strong>Electric advantages:</strong><br>‚Ä¢ Dedicated bus lanes<br>‚Ä¢ Traffic signal priority<br>‚Ä¢ 8+ minutes faster than regular traffic<br>‚Ä¢ Real-time tracking & arrival predictions<br><br>üîå <strong>Charging network:</strong><br>‚Ä¢ 12 charging stations across Ajman<br>‚Ä¢ 99.5% fleet uptime<br>‚Ä¢ Smart grid integration';
            } else if (lower.includes('pay') || lower.includes('masaar') || lower.includes('balance')) {
                response = 'üí≥ <strong>Masaar Payment System</strong><br><br>üí∞ <strong>Your current balance:</strong> 127.50 AED<br><br>üì± <strong>Payment methods:</strong><br>‚Ä¢ <strong>NFC:</strong> Tap phone to bus reader<br>‚Ä¢ <strong>QR Code:</strong> Scan at entrance<br>‚Ä¢ <strong>Physical card:</strong> Traditional tap & go<br><br>üí° <strong>Top-up options:</strong><br>‚Ä¢ Mobile app (instant transfer)<br>‚Ä¢ ATM machines (50+ locations)<br>‚Ä¢ Retail stores (Carrefour, Lulu, etc.)<br>‚Ä¢ Online banking portal<br><br>üé´ <strong>Save money:</strong> Monthly passes offer 25% discount for frequent travelers!';
            } else if (lower.includes('family') || lower.includes('track') || lower.includes('children')) {
                response = 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶ <strong>Family Tracking & Safety</strong><br><br>üì± <strong>Currently tracking:</strong><br>‚Ä¢ <strong>Khalid</strong> - On Bus AJX, arriving City Center in 8 min<br>‚Ä¢ <strong>Sara</strong> - On Bus B7, ETA Al Noor School 15 min<br>‚Ä¢ <strong>Ahmed</strong> - Safely arrived at UAE University<br><br>üîî <strong>Smart notifications:</strong><br>‚Ä¢ Bus departure alerts (5 min before)<br>‚Ä¢ Safe arrival confirmations<br>‚Ä¢ Route delay notifications<br>‚Ä¢ Emergency contact alerts<br><br>üõ°Ô∏è <strong>Privacy & security:</strong><br>‚Ä¢ End-to-end encrypted location data<br>‚Ä¢ Only family members can see tracking<br>‚Ä¢ Data automatically deleted after 24 hours';
            } else if (lower.includes('hello') || lower.includes('hi') || lower.includes('help')) {
                response = 'üëã <strong>Welcome to Tayyar AI!</strong><br><br>I\'m here to help with all your transit needs:<br><br>üöå <strong>What I can do:</strong><br>‚Ä¢ Plan optimal routes & transfers<br>‚Ä¢ Real-time bus tracking & ETAs<br>‚Ä¢ Find nearby amenities & services<br>‚Ä¢ Tourism routes & attraction info<br>‚Ä¢ Masaar payment & balance help<br>‚Ä¢ Family member tracking<br>‚Ä¢ Service updates & delays<br>‚Ä¢ Villa community minibus info<br><br>üí¨ <strong>Try asking:</strong><br>"How do I get to City Center?"<br>"Where are the nearest restrooms?"<br>"Show me tourism routes"<br>"Check my Masaar balance"';
            } else if (lower.includes('university') || lower.includes('student')) {
                response = 'üéì <strong>University Transport</strong><br><br>üöå <strong>Best route to UAE University:</strong><br>‚Ä¢ Take Bus AJX (‚ö° Electric) from School Complex<br>‚Ä¢ Journey time: 22 minutes<br>‚Ä¢ Frequency: Every 12 minutes<br>‚Ä¢ Cost: 3.50 AED with Masaar<br><br>üéí <strong>Student benefits:</strong><br>‚Ä¢ Student monthly pass: 75 AED (50% off)<br>‚Ä¢ Early morning services (6:00 AM start)<br>‚Ä¢ Late evening return trips (until 10:00 PM)<br>‚Ä¢ Study areas at major stops<br><br>üìö <strong>Campus amenities:</strong><br>‚Ä¢ Library, food court, prayer rooms<br>‚Ä¢ Bike parking at bus stop<br>‚Ä¢ Free WiFi while waiting';
            } else {
                response = 'ü§ñ <strong>AI Assistant</strong><br><br>I understand you\'re asking about: <em>"' + message + '"</em><br><br>üöå <strong>I can help with:</strong><br>‚Ä¢ Route planning & navigation<br>‚Ä¢ Live bus tracking & timing<br>‚Ä¢ Payment & balance queries<br>‚Ä¢ Tourism & attractions info<br>‚Ä¢ Family member tracking<br>‚Ä¢ Villa minibus services<br>‚Ä¢ Environmental info (electric buses)<br><br>üí¨ <strong>Try being more specific:</strong><br>"Plan route to [destination]"<br>"Find amenities near [location]"<br>"Show tourism routes"<br>"Check bus delays"<br>"Villa community transport"';
            }
            
            addMessage(response, 'ai');
        }

        // Enhanced payment functions
        function topUpBalance() {
            showModal('Top Up Balance', 
                'Choose your top-up amount:<br><br>' +
                '<button class="action-btn" onclick="processPayment(25)">25 AED</button>' +
                '<button class="action-btn" onclick="processPayment(50)">50 AED</button>' +
                '<button class="action-btn" onclick="processPayment(100)">100 AED</button>' +
                '<button class="action-btn" onclick="processPayment(200)">200 AED</button>'
            );
        }

        function initiateNFCPayment() {
            showModal('NFC Payment', 
                'üì± <strong>Ready for NFC Payment</strong><br><br>' +
                'Hold your phone near the NFC reader on the bus entrance.<br><br>' +
                '<div class="spinner"></div><br>' +
                'Waiting for connection...'
            );
            
            setTimeout(() => {
                document.getElementById('modalBody').innerHTML = 
                    '‚úÖ <strong>Payment Successful!</strong><br><br>' +
                    'Amount: 3.50 AED<br>' +
                    'Route: Bus AJX<br>' +
                    'New balance: 124.00 AED<br><br>' +
                    'Have a safe journey!';
                updateBalance(-3.50);
                addTransaction('Bus AJX - Just now', -3.50);
            }, 3000);
        }

        function showPasses() {
            showModal('Monthly Passes', 
                'Available subscription options:<br><br>' +
                '<button class="action-btn" onclick="processPayment(-75, \'Student Pass purchased!\')">Student Pass - 75 AED/month<br><small>50% discount for students</small></button>' +
                '<button class="action-btn" onclick="processPayment(-150, \'Regular Pass purchased!\')">Regular Pass - 150 AED/month<br><small>Unlimited rides on all routes</small></button>' +
                '<button class="action-btn" onclick="processPayment(-45, \'Tourist Pass purchased!\')">Tourist Pass - 45 AED/week<br><small>Includes all tourism routes</small></button>'
            );
        }

        function showTransactionHistory() {
            const history = `
                <div style="text-align: left; font-size: 14px; line-height: 1.6;">
                    <div style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: #f9f9f9; border-radius: 6px;">
                        <span>Bus AJX - Today 6:30 PM</span>
                        <span style="color: var(--danger); font-weight: 600;">-3.50 AED</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: #f9f9f9; border-radius: 6px;">
                        <span>Top Up - Yesterday</span>
                        <span style="color: var(--success); font-weight: 600;">+50.00 AED</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: #f9f9f9; border-radius: 6px;">
                        <span>Bus B7 - Yesterday 4:15 PM</span>
                        <span style="color: var(--danger); font-weight: 600;">-3.50 AED</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: #f9f9f9; border-radius: 6px;">
                        <span>Monthly Pass - Oct 1</span>
                        <span style="color: var(--danger); font-weight: 600;">-75.00 AED</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: #f9f9f9; border-radius: 6px;">
                        <span>Top Up ATM - Sep 30</span>
                        <span style="color: var(--success); font-weight: 600;">+100.00 AED</span>
                    </div>
                </div>
            `;
            showModal('Transaction History', history);
        }

        function processPayment(amount, successMessage = '') {
            closeModal();
            
            if (amount > 0) {
                showModal('Processing Payment', 
                    'üí≥ Processing top-up...<br><br>' +
                    '<div class="spinner"></div><br>' +
                    'Please wait...'
                );
                
                setTimeout(() => {
                    updateBalance(amount);
                    addTransaction(`Top Up - Just now`, amount);
                    document.getElementById('modalBody').innerHTML = 
                        `‚úÖ <strong>Top-up Successful!</strong><br><br>` +
                        `Amount added: ${amount} AED<br>` +
                        `New balance: ${parseFloat(document.getElementById('balance').textContent) + amount} AED`;
                    showNotification(`+${amount} AED added to your balance`);
                }, 2000);
            } else {
                updateBalance(amount);
                addTransaction(successMessage.replace(' purchased!', '') + ' - Just now', amount);
                showNotification(successMessage);
            }
        }

        function updateBalance(amount) {
            const balanceElement = document.getElementById('balance');
            const currentBalance = parseFloat(balanceElement.textContent);
            const newBalance = currentBalance + amount;
            balanceElement.textContent = newBalance.toFixed(2) + ' AED';
            
            // Animate balance change
            balanceElement.style.transform = 'scale(1.1)';
            balanceElement.style.color = amount >= 0 ? 'white' : '#ffcccc';
            
            setTimeout(() => {
                balanceElement.style.transform = 'scale(1)';
                balanceElement.style.color = 'white';
            }, 500);
        }

        function addTransaction(title, amount) {
            const transactionList = document.getElementById('transactionList');
            const transaction = document.createElement('div');
            transaction.className = 'transaction fade-in';
            transaction.style.cssText = 'display: flex; justify-content: space-between; margin: 8px 0; padding: 8px 0; border-bottom: 1px solid var(--border);';
            
            const titleSpan = document.createElement('span');
            titleSpan.textContent = title;
            
            const amountSpan = document.createElement('span');
            amountSpan.textContent = (amount >= 0 ? '+' : '') + amount.toFixed(2) + ' AED';
            amountSpan.style.color = amount >= 0 ? 'var(--success)' : 'var(--danger)';
            
            transaction.appendChild(titleSpan);
            transaction.appendChild(amountSpan);
            
            transactionList.insertBefore(transaction, transactionList.firstChild);
        }

        // Family & Modal functions
        function showMemberDetails(name) {
            let info = '';
            switch(name) {
                case 'Khalid':
                    info = `<strong>üë¶ Khalid</strong><br><br>
                        üìç Currently on Bus AJX<br>
                        üéØ Destination: City Center<br>
                        ‚è∞ ETA: 7:15 PM (8 minutes)<br>
                        üõ£Ô∏è Next stop: Al Bustan<br><br>
                        üîî Notifications: Active<br>
                        üì± Last update: 30 seconds ago`;
                    break;
                case 'Sara':
                    info = `<strong>üëß Sara</strong><br><br>
                        üìç Currently on Bus B7<br>
                        üéØ Destination: Al Noor School<br>
                        ‚è∞ ETA: 7:30 PM (15 minutes)<br>
                        üõ£Ô∏è Next stop: Al Jurf<br><br>
                        üîî Notifications: Active<br>
                        üì± Last update: 45 seconds ago`;
                    break;
                case 'Ahmed':
                    info = `<strong>üë® Ahmed</strong><br><br>
                        ‚úÖ Safely arrived at UAE University<br>
                        üïê Arrival time: 6:45 PM<br>
                        üõ£Ô∏è Journey: Home ‚Üí University (22 min)<br>
                        üöå Used: Bus AJX (Electric)<br><br>
                        üìä Journey history available<br>
                        üì± Status confirmed: 15 minutes ago`;
                    break;
            }
            showModal('Family Member Details', info);
        }

        function toggleNotifications() {
            const isEnabled = localStorage.getItem('notificationsEnabled') !== 'false';
            localStorage.setItem('notificationsEnabled', !isEnabled);
            showNotification(isEnabled ? 'Notifications disabled' : 'Notifications enabled');
        }

        function addFamilyMember() {
            showModal('Add Family Member', 
                'Add a new family member to track:<br><br>' +
                '<input type="text" placeholder="Member name" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; margin: 8px 0;"><br>' +
                '<input type="text" placeholder="Phone number" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; margin: 8px 0;"><br>' +
                '<button class="action-btn" onclick="showNotification(\'Family member added successfully!\'); closeModal();">Add Member</button>'
            );
        }

        // Tourism & Attraction functions
        function showAttractionDetails(attraction) {
            let info = '';
            switch(attraction) {
                case 'Museum':
                    info = `<strong>üèõÔ∏è Ajman Museum</strong><br><br>
                        üìç Located in historic 18th-century fort<br>
                        üïò Hours: 9:00 AM - 7:00 PM daily<br>
                        üé´ Entry: 5 AED (Free with Discovery Pass)<br><br>
                        üè∫ <strong>Exhibits:</strong><br>
                        ‚Ä¢ Traditional Emirati life<br>
                        ‚Ä¢ Archaeological artifacts<br>
                        ‚Ä¢ Maritime history<br>
                        ‚Ä¢ Manuscript collection<br><br>
                        üöå Served by RT1 every 20 minutes`;
                    break;
                case 'Corniche':
                    info = `<strong>üåä Ajman Corniche</strong><br><br>
                        üèñÔ∏è 4km beautiful waterfront promenade<br>
                        üåÖ Perfect for sunset views<br><br>
                        üèÉ‚Äç‚ôÇÔ∏è <strong>Activities:</strong><br>
                        ‚Ä¢ Jogging & cycling paths<br>
                        ‚Ä¢ Beach access & swimming<br>
                        ‚Ä¢ Restaurants & caf√©s<br>
                        ‚Ä¢ Children's play areas<br>
                        ‚Ä¢ Evening markets<br><br>
                        üöå Served by RT1 every 20 minutes<br>
                        üÖøÔ∏è Free parking available`;
                    break;
                case 'Al Zorah':
                    info = `<strong>üèùÔ∏è Al Zorah Nature Reserve</strong><br><br>
                        üåø Protected mangrove ecosystem<br>
                        üèåÔ∏è Championship golf course<br>
                        üõ•Ô∏è Luxury marina & residences<br><br>
                        üö£‚Äç‚ôÄÔ∏è <strong>Activities:</strong><br>
                        ‚Ä¢ Kayaking tours<br>
                        ‚Ä¢ Paddleboarding<br>
                        ‚Ä¢ Bird watching<br>
                        ‚Ä¢ Nature walks<br>
                        ‚Ä¢ Fine dining restaurants<br><br>
                        üöå Served by RT2 every 30 minutes`;
                    break;
                case 'Mall':
                    info = `<strong>üõçÔ∏è City Center Ajman</strong><br><br>
                        üè¨ 80+ international stores & brands<br>
                        üïò Hours: 10:00 AM - 10:00 PM daily<br><br>
                        üéØ <strong>Features:</strong><br>
                        ‚Ä¢ Carrefour hypermarket<br>
                        ‚Ä¢ VOX Cinemas (8 screens)<br>
                        ‚Ä¢ Magic Planet entertainment<br>
                        ‚Ä¢ 25+ restaurants & caf√©s<br>
                        ‚Ä¢ Prayer rooms & nursery<br><br>
                        üöå Major transport hub - all routes stop here`;
                    break;
            }
            showModal('Attraction Information', info);
        }

        function showRouteDetails(routeId) {
            let info = '';
            switch(routeId) {
                case 'RT1':
                    info = `<strong>üèõÔ∏è RT1: City Heritage Tour</strong><br><br>
                        ‚è∞ Every 20 minutes | 45 min full loop<br><br>
                        üöè <strong>Route stops:</strong><br>
                        1. City Center Ajman<br>
                        2. Ajman Museum<br>
                        3. Traditional Souk<br>
                        4. Ajman Corniche<br>
                        5. Heritage Village<br>
                        6. Luxury Hotels District<br><br>
                        üé´ Day Pass: 15 AED (Unlimited rides)<br>
                        üéß Audio guide available in Arabic & English`;
                    break;
                case 'RT2':
                    info = `<strong>üèñÔ∏è RT2: Beach & Nature</strong><br><br>
                        ‚è∞ Every 30 minutes | 40 min full loop<br><br>
                        üöè <strong>Route stops:</strong><br>
                        1. City Center Ajman<br>
                        2. Al Zorah Nature Reserve<br>
                        3. Marina & Golf Resort<br>
                        4. Public Beach Access<br>
                        5. Beachfront Hotels<br>
                        6. Fishing Harbor<br><br>
                        üé´ Day Pass: 15 AED (Unlimited rides)<br>
                        üèä‚Äç‚ôÄÔ∏è Beach equipment rental available`;
                    break;
                case 'RT3':
                    info = `<strong>üè® RT3: Hotel Circuit</strong><br><br>
                        ‚è∞ Every 25 minutes | 35 min full loop<br><br>
                        üöè <strong>Route stops:</strong><br>
                        1. Fairmont Ajman<br>
                        2. Ajman Saray Resort<br>
                        3. Oberoi Beach Resort<br>
                        4. Ramada Hotel<br>
                        5. City Center Ajman<br><br>
                        üé´ Day Pass: 15 AED (Unlimited rides)<br>
                        üß≥ Luggage assistance available`;
                    break;
            }
            showModal('Tourism Route Details', info + '<br><button class="action-btn" onclick="purchaseDiscoveryPass()">Purchase Day Pass (15 AED)</button>');
        }

        function showMinibusDetails(route) {
            showModal('Villa Minibus Service',
                `<strong>üöê Al Amerah Electric Minibus</strong><br><br>
                ‚ö° 100% electric, zero-emission vehicles<br>
                üïò Operating hours: 6:00 AM - 10:00 PM<br>
                ‚è∞ Frequency: Every 10-15 minutes<br><br>
                üìè <strong>Route details:</strong><br>
                ‚Ä¢ Total distance: 7.2 km<br>
                ‚Ä¢ 8 stops throughout community<br>
                ‚Ä¢ 13 minutes end-to-end<br>
                ‚Ä¢ Connects to Bus B7 at Al Jurf<br><br>
                ‚úÖ <strong>Accessibility:</strong><br>
                ‚Ä¢ Wheelchair accessible<br>
                ‚Ä¢ Low-floor entry<br>
                ‚Ä¢ All villas within 5-10 min walk<br>
                ‚Ä¢ Bike racks available<br><br>
                üí∞ Standard Masaar fare: 3.50 AED`
            );
        }

        function showBusDetails(busId) {
            let info = '';
            switch(busId) {
                case 'AJX':
                    info = `<strong>‚ö° Electric Bus AJX</strong><br><br>
                        üìç Current location: 4 minutes from School Complex<br>
                        üõ£Ô∏è Route: School Complex ‚Üí University ‚Üí City Center<br>
                        ‚è∞ Next arrival: 4 minutes<br><br>
                        ‚ú® <strong>Features:</strong><br>
                        ‚Ä¢ Free WiFi & USB charging<br>
                        ‚Ä¢ Wheelchair accessible<br>
                        ‚Ä¢ Air conditioning<br>
                        ‚Ä¢ Real-time announcements<br><br>
                        üö¶ Bus lane active - 8 min time savings<br>
                        üîã 100% electric - zero emissions`;
                    break;
                case 'RT1':
                    info = `<strong>üèõÔ∏è Tourism Bus RT1</strong><br><br>
                        üìç Current location: 8 minutes from City Center<br>
                        üõ£Ô∏è Route: Heritage Tour Circuit<br>
                        ‚è∞ Next arrival: 8 minutes<br><br>
                        ‚ú® <strong>Features:</strong><br>
                        ‚Ä¢ Panoramic windows<br>
                        ‚Ä¢ Multilingual audio guides<br>
                        ‚Ä¢ Tourist information displays<br>
                        ‚Ä¢ Souvenir sales onboard<br><br>
                        üé´ Day Pass required (15 AED)<br>
                        üì± Digital tour guide app available`;
                    break;
                case 'B7':
                    info = `<strong>üöå Bus B7</strong><br><br>
                        üìç Current location: 12 minutes from School Complex<br>
                        üõ£Ô∏è Route: School Complex ‚Üí Al Jurf ‚Üí City Center<br>
                        ‚è∞ Next arrival: 12 minutes<br><br>
                        ‚ú® <strong>Features:</strong><br>
                        ‚Ä¢ WiFi & USB charging<br>
                        ‚Ä¢ Air conditioning<br>
                        ‚Ä¢ Priority seating for elderly<br>
                        ‚Ä¢ Bike racks (2 bikes)<br><br>
                        üèñÔ∏è Serves beach and shopping areas<br>
                        ‚ôø Fully accessible`;
                    break;
            }
            showModal('Bus Information', info);
        }

        function showStopDetails(stopName) {
            let info = '';
            switch(stopName) {
                case 'School Complex':
                    info = `<strong>üöè School Complex Bus Stop</strong><br><br>
                        üöå <strong>Buses serving this stop:</strong><br>
                        ‚Ä¢ AJX (‚ö° Electric) - 4 min<br>
                        ‚Ä¢ B7 - 12 min<br><br>
                        üè¢ <strong>Nearby amenities:</strong><br>
                        ‚Ä¢ Clean restrooms with baby changing<br>
                        ‚Ä¢ Costa Coffee (2 min walk)<br>
                        ‚Ä¢ ADCB ATM (Masaar top-up)<br>
                        ‚Ä¢ Covered waiting area<br>
                        ‚Ä¢ Real-time arrival displays<br><br>
                        üéì Main stop for 5 schools in area<br>
                        üìç 6 minutes walk from your location`;
                    break;
                case 'City Center':
                    info = `<strong>üöè City Center Bus Stop</strong><br><br>
                        üöå <strong>Buses serving this stop:</strong><br>
                        ‚Ä¢ B7 - 12 min<br>
                        ‚Ä¢ RT1 (Tourism) - 8 min<br>
                        ‚Ä¢ RT3 (Hotels) - 15 min<br><br>
                        üè¢ <strong>Major amenities:</strong><br>
                        ‚Ä¢ Full shopping mall<br>
                        ‚Ä¢ 25+ restaurants & food court<br>
                        ‚Ä¢ VOX Cinemas<br>
                        ‚Ä¢ Multiple ATMs<br>
                        ‚Ä¢ Prayer rooms & nursery<br><br>
                        üöá Main transfer hub - all routes connect here<br>
                        üìç 15 minutes walk from your location`;
                    break;
                case 'Al Jurf':
                    info = `<strong>üöè Al Jurf Bus Stop</strong><br><br>
                        üöå <strong>Buses serving this stop:</strong><br>
                        ‚Ä¢ B7 - 18 min<br>
                        ‚Ä¢ Villa minibus connection<br><br>
                        üèñÔ∏è <strong>Beach area amenities:</strong><br>
                        ‚Ä¢ Public beach access<br>
                        ‚Ä¢ Restrooms & shower facilities<br>
                        ‚Ä¢ Beachside caf√©s<br>
                        ‚Ä¢ Public park with playground<br>
                        ‚Ä¢ Free parking area<br><br>
                        üöê Connect to Al Amerah minibus here<br>
                        üìç 10 minutes walk from your location`;
                    break;
                case 'University':
                    info = `<strong>üöè UAE University Bus Stop</strong><br><br>
                        üöå <strong>Buses serving this stop:</strong><br>
                        ‚Ä¢ AJX (‚ö° Electric) - 22 min<br><br>
                        üéì <strong>Campus amenities:</strong><br>
                        ‚Ä¢ Student services center<br>
                        ‚Ä¢ Multiple cafeterias<br>
                        ‚Ä¢ Library access<br>
                        ‚Ä¢ Prayer rooms<br>
                        ‚Ä¢ ATM machines<br>
                        ‚Ä¢ Bike parking & rental<br><br>
                        üéí Student monthly pass: 75 AED (50% off)<br>
                        üìç 5 minutes walk to main campus`;
                    break;
            }
            showModal('Bus Stop Information', info);
        }

        function purchaseDiscoveryPass() {
            showModal('Purchase Discovery Pass',
                `<strong>üé´ Tourism Discovery Pass</strong><br><br>
                ‚úÖ Unlimited rides on all tourism routes<br>
                ‚úÖ Valid for 24 hours from first use<br>
                ‚úÖ Audio guides included<br>
                ‚úÖ 10% discount at partner attractions<br><br>
                üí∞ <strong>Price: 15 AED</strong><br><br>
                <button class="action-btn" onclick="processPayment(-15, 'Discovery Pass purchased! Valid for 24 hours.')">Purchase Now (15 AED)</button>`
            );
        }

        // Utility functions
        function showModal(title, content) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').innerHTML = content;
            const modal = document.getElementById('modal');
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('active'), 10);
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            modal.classList.remove('active');
            setTimeout(() => modal.style.display = 'none', 300);
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => notification.classList.remove('show'), 3000);
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            showScreen(1);
            
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') sendMessage();
                });
            }
            
            // Auto-refresh live data
            setInterval(() => {
                document.querySelectorAll('.stop-eta').forEach(eta => {
                    if (eta.textContent.includes('min')) {
                        let minutes = parseInt(eta.textContent);
                        if (minutes > 1) {
                            eta.textContent = `${minutes - 1} min`;
                        } else {
                            eta.textContent = 'Arriving';
                            eta.style.background = 'var(--warning)';
                        }
                    }
                });
                
                document.querySelectorAll('.bus-marker span').forEach(marker => {
                    const text = marker.textContent;
                    if (text.includes('min')) {
                        const parts = text.split(' - ');
                        let minutes = parseInt(parts[1]);
                        if (minutes > 1) {
                            marker.textContent = `${parts[0]} - ${minutes - 1} min`;
                        }
                    }
                });
            }, 30000);
            
            // Simulate family updates
            setInterval(() => {
                const traveling = document.querySelectorAll('.status-traveling');
                if (traveling.length > 0 && Math.random() > 0.8) {
                    const member = traveling[Math.floor(Math.random() * traveling.length)];
                    const name = member.closest('.family-member').querySelector('[style*="font-weight: 600"]').textContent;
                    
                    member.textContent = 'Arrived';
                    member.className = 'member-status status-arrived';
                    
                    if (localStorage.getItem('notificationsEnabled') !== 'false') {
                        showNotification(`${name} has arrived safely!`);
                    }
                }
            }, 45000);
        });
    </script>
</body>
</html>